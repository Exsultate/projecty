<template>
  <div class="Authentication vh-100 d-flex align-items-center">
    <div class="">
      <b-row class="authwindow border border-secondary">
        <b-col sm="6">
          <b-img
            thumbnail
            center
            src="./assets/Authentication/images/logo.png"
          ></b-img>
        </b-col>
        <b-col sm="6">
          <b-form @submit="onRegister" @reset="onReset" v-if="showRegistration" >
            <b-form-group>
              <b-form-input class="border border-secondary"
                id="input-1"
                v-model="form.email"
                type="email"
                placeholder="Enter email"
                required
              ></b-form-input>
            </b-form-group>

            <b-form-group id="input-group-2">
              <b-form-input class="mt-2 border border-secondary"
                type="password"
                id="input-2"
                v-model="form.password"
                placeholder="Password"
                required
              ></b-form-input>
            </b-form-group>

            <b-row class="mt-2">
              <b-button block type="submit" variant="primary">Register</b-button>
            </b-row>

            <b-row class="mt-2">
              <b-button block type="reset" variant="danger">Reset</b-button>
            </b-row>
          </b-form>
          <b-form @submit="onLogin" @reset="onResetPassword" v-else-if="showLogin" >
            <h2>{{ username }}</h2>

            <b-form-group id="input-group-2">
              <b-form-input class="mt-2 border border-secondary"
                type="password"
                id="input-2"
                v-model="form.password"
                placeholder="Password"
                required
              ></b-form-input>
            </b-form-group>

            <b-row class="mt-2">
              <b-button block type="submit" variant="primary">Login</b-button>
            </b-row>

            <b-row class="mt-2">
              <b-button block type="reset" variant="danger">Reset password</b-button>
            </b-row>
          </b-form>
        </b-col>
        
        <b-col sm="12" class="border-top border-secondary"> Powered by </b-col>
      </b-row>
    </div>
  </div>
</template>

<script>
export default {
  name: 'Auth',
  props:{
    username: String
  },
  data() {
    return {
      form: {
        email: "",
        password: "",
      },
      showRegistration: false,
      showLogin: false
    };
  },
  methods: {
    onRegister(event) {
      event.preventDefault();
      this.mp.trigger("Authentication:Register", this.form.email, this.form.password);
    },
    onReset(event) {
      event.preventDefault();
      // Reset our form values
      this.form.email = "";
      this.form.password = "";
      // Trick to reset/clear native browser form validation state
      this.showRegistration = false;
      this.$nextTick(() => {
        this.showRegistration = true;
      });
    },
    onLogin(event) {
      event.preventDefault();
      this.mp.trigger("Authentication:TryLogin", this.form.password);
    },
    onResetPassword(event) {
      event.preventDefault();
      // Reset our form values
      this.form.password = "";
      // Trick to reset/clear native browser form validation state
      this.showLogin = false;
      this.$nextTick(() => {
        this.showLogin = true;
      });
    },
    Authentication_InitializeRegisterScreen(username){
      this.username = username;
      this.showRegistration = true;
      alert("register");
    },
    Authentication_InitializeLoginScreen(username){
      this.username = username;
      this.showLogin = true;
      alert("login");
    },
  },
};
</script>

<style scoped lang="scss">

$base-color: #000000;
$secondary-color: #ffa600;

$theme-colors: (
  primary: $base-color,
  secondary: $secondary-color,
);

.col-sm-6 {
  padding: 15px;
}
form * {
  margin-left: 0px;
  margin-right: 5px;
}
.img-thumbnail {
  min-height: 100%;
  background: $secondary-color;
  border: $secondary-color;
}

.btn-danger,
.btn-primary {
  border: none;
}

.btn-primary {
  background: $secondary-color;
}

.authwindow{
  background: rgba($base-color, 0.75);
  border-radius: 10px;
  margin-left: 25%;
  margin-right: 25%;
}

body,html{
  background: none;
}

.Authentication{
  background: none;
}

.border-secondary{
   border-color: $secondary-color !important;
}
</style>
